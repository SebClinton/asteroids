!doctype html>
<html>
<head>
    <title>animating asteroids</title> 
    <link rel="stylesheet" href="styles.css">
    <script src="drawing.js"></script>
</head>
<body>
<h1>animation</h1>  
<canvas id="asteroids" width="600" height="600"></canvas>
<script>
var context = document.getElementById("asteroids").
getContext("2d");

var asteroid = {
    segments: 24,
    shape: [],
    radius: 50,
    noise: 0.5,
    x: context.canvas.width * Math.random(),
    y: context.canvas.height * Math.random(),
    angle: 0,
    x_speed: context.canvas.width * (Math.random() - 0.5),
    y_speed: context.canvas.height * (Math.random() - 0.5),
    rotation_speed: 2 * Math.PI * (Math.random() - 0.5)
};

for(var i = 0; i < asteroid.segments; i++) {
    asteroid.shape.push(Math.random() - 0.5);
}

function draw(ctx, guide) {
    if(guide) {
        draw_grid(ctx);
    }
ctx.save();
ctx.translate(asteroid.x, asteroid.y);
ctx.rotate(asteroid.angle);
draw_asteroid(ctx, asteroid.radius, asteroid.shape, {
    guide: guide,
    noise: asteroid.noise
});
ctx.restore();
}

function update(elapsed) {
    if(x - radius + elapsed * x_speed > context.canvas.width) 
    {x = -radius;}
    if(x + radius + elapsed * x_speed < 0) {x = context.canvas.width + radius;}
    if(y - radius + elapsed * y_speed > context.canvas.height)
    {y = -radius;}
    if(y + radius + elapsed * y_speed < 0) {y = context.canvas.height + radius;}
    x += elapsed * x_speed;
    y += elapsed * y_speed;
    angle = (angle + elapsed * rotation_speed) % (2 * Math.PI);
}

var previous, elapsed;
function frame(timestamp) {
    context.clearRect(0, 0, context.canvas.width, context.canvas.height);
    if (!previous) previous = timestamp;
    elapsed = timestamp - previous;
    update(elapsed / 1000);
    draw(context, true);
    previous = timestamp;
    window.requestAnimationFrame(frame);

}
window.requestAnimationFrame(frame);
       </script>
    </body>
</html>